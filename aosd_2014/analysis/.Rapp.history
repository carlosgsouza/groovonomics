data<-read.table("minutes.txt")
qplot(data[,1], binwidth=5)
library(psych)#
library(sm)#
library(ggplot2)#
library(MASS)#
#
setwd("~/workspace_gg/groovonomics/aosd_2014/analysis")#
#
data_all<-read.table("parsed/declaration_by_type.txt", header=T)#
describe(data_all)#
#
data_tests_all<-read.table("parsed/declaration_by_tests.txt", header=T)#
describe(data_tests_all)#
#
data_scripts_all<-read.table("parsed/declaration_by_scripts.txt", header=T)#
describe(data_scripts_all)#
#
data_background_all<-read.table("parsed/declaration_by_background.txt", header=T)#
describe(data_background_all)#
#
matureData=data_all[data_all$loc>2000 & data_all$commits>100, ]#
nonMatureData=data_all[data_all$loc<=2000 | data_all$commits<=100, ]#
#
testData=data_tests_all[data_tests_all$condition=="test", ]#
mainData=data_tests_all[data_tests_all$condition=="not-test", ]#
#
scriptData=data_scripts_all[data_scripts_all$condition=="script", ]#
classData=data_scripts_all[data_scripts_all$condition=="not-script", ]#
#
staticBackgroundData=data_background_all[data_background_all$condition=="static-only", ]#
dynamicBackgroundData=data_background_all[data_background_all$condition=="dynamic-only", ]#
staticAndDynamicBackgroundData=data_background_all[data_background_all$condition=="static-and-dynamic", ]#
#
data_size=data_all#
data_size$condition=NA#
data_size[data_size$loc<=200, ]$condition="1-small"#
data_size[data_size$loc>200 & data_size$loc<=2000, ]$condition="2-medium"#
data_size[data_size$loc>2000 & data_size$loc<=20000, ]$condition="3-big"#
data_size[data_size$loc>20000, ]$condition="4-huge"#
#
smallData=data_size[data_size$condition=="1-small", ]#
mediumData=data_size[data_size$condition=="2-medium", ]#
bigData=data_size[data_size$condition=="3-big", ]#
hugeData=data_size[data_size$condition=="4-huge", ]
i<-data.frame(	#
				projectId=1,#
				loc=2,#
				commits=3,#
				age=4,#
#
				all=5, #
#
				localVariable=6,#
				methodReturn=7,#
				methodParameter=8,#
				constructorParameter=9,#
				field=10,#
				privateMethodReturn=11,#
				protectedMethodReturn=12,#
				publicMethodReturn=13,#
				privateMethodParameter=14,#
				protectedMethodParameter=15,#
				publicMethodParameter=16,#
				privateConstructorParameter=17,#
				protectedConstructorParameter=18,#
				publicConstructorParameter=19,#
				privateField=20,#
				protectedField=21,#
				publicField=22,#
				private=23,#
				protected=24,#
				public=25#
			)#
label<-c(#
		"project id",#
		"LOC",#
		"number of commits",#
		"age",#
		"all types",#
#
		"local variables",#
		"returns of methods",#
		"parameters of methods",#
		"parameters of constructors",#
		"fields",#
#
		"returns of private methods",#
		"returns of protected methods",#
		"returns of public methods",#
#
		"parameters of private methods",#
		"parameters of protected methods",#
		"parameters of public methods",#
#
		"parameters of private constructors",#
		"parameters of protected constructors",#
		"parameters of public constructors",#
#
		"private fields",#
		"protected fields",#
		"public fields",#
#
		"private fields and methods",#
		"protected fields and methods",#
		"public fields and methods"#
)#
#
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Usage of types in declarations of",  declarationTypeStr, "per project")) + #
 		xlim(0,1.1)#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$localVariable:i$public )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
# Uses Mann Whitney tests to compare if two samples are equal#
uTestElementsOfASample<-function(data, folder, description, columns) {#
	result = data.frame(sample1=character(0), sample2=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	row = 1#
	for(i in columns) { #
		for(j in columns) { #
			if(i < j) {#
				d_i=data[!is.na(data[,i]),i]#
				d_j=data[!is.na(data[,i]),j]#
				test<-wilcox.test(d_i, d_j, conf.int=T)#
				print(test)#
				p=round(test$p.value, 3)#
				conf.int.min=round(test$conf.int[1], 3)#
				conf.int.max=round(test$conf.int[2], 3)#
				result <- rbind(result, data.frame(sample1=colnames(data)[i], sample2=colnames(data)[j], pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
				row=row+1#
			}#
		}#
	}#
	write.matrix(result ,file=paste("result/", folder, "/u-test/", gsub(" ", "_", description), ".txt", sep=""))#
}#
#
uTestSamples<-function(data1, data2, data1Description, data2Description, folder, columns) {#
	print(paste("Comparing", data1Description, "and", data2Description))#
	result = data.frame(element=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	for(c in columns) { #
		element=colnames(data1)[c]#
		print(element)#
		d_1=data1[!is.na(data1[,c]),c]#
		d_2=data2[!is.na(data2[,c]),c]#
		if(length(d_1) > 1 && length(d_2) > 1) {#
			test<-wilcox.test(d_1, d_2, conf.int=T)#
			print(test)#
			p=round(test$p.value, 3)#
			conf.int.min=round(test$conf.int[1], 3)#
			conf.int.max=round(test$conf.int[2], 3)#
			result <- rbind(result, data.frame(element=element, pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
		}#
	}#
	write.matrix(result ,file=paste("result/", folder, "/comparison/u-test/", data1Description, "_", data2Description, ".txt", sep=""))#
}#
uTestSamples(smallData, mediumData, "1-small", "2-medium", "size", i$all:i$public)#
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="")#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=7, height=length(columns))#
}#
#
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot() + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom")#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=7, height=max(3.0, 1.5*length(columns)))#
}#
#
compareAllSamples<-function() {#
	# Tests classes X Main classes#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "all declarations",			i$all)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "fields", 						i$privateField:i$publicField)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by visibility",	i$private:i$public)#
	uTestSamples(testData, mainData, "test", "main", "test", i$all:i$public)#
	# Scripts X Classes#
	comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "all declarations",		i$all)#
	comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "declarations by type",	i$localVariable:i$methodParameter)#
	uTestSamples(scriptData, classData, "script", "class", "script", c(i$all, i$localVariable:i$methodParameter))#
	# Programmers background#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "all declarations",			i$all)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by visibility",	i$private:i$public)#
	uTestSamples(staticBackgroundData, dynamicBackgroundData,			"static", "dynamic",			"background", i$all:i$public)#
	uTestSamples(staticBackgroundData, staticAndDynamicBackgroundData,	"static", "static-and-dynamic",	"background", i$all:i$public)#
	uTestSamples(dynamicBackgroundData, staticAndDynamicBackgroundData,	"dynamic", "static-and-dynamic","background", i$all:i$public)#
	# Size#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "all declarations",			i$all)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "declarations by visibility",	i$private:i$public)#
#
	uTestSamples(smallData, mediumData, "1-small", "2-medium", "size", i$all:i$public)#
	uTestSamples(smallData, bigData,	"1-small", "3-big", "size", i$all:i$public)#
	uTestSamples(smallData, hugeData,	"1-small", "4-huge", "size", i$all:i$public)#
	uTestSamples(mediumData, bigData,	"2-medium", "3-big", "size", i$all:i$public)#
	uTestSamples(mediumData, hugeData,	"2-medium", "4-huge", "size", i$all:i$public)#
	uTestSamples(bigData, hugeData,		"3-big", "4-huge", "size", i$all:i$public)#
#
}#
#
filterColumnsWithData<-function(data, columns) {#
	columnsWithData=numeric()#
	for(c in columns) {#
		if(length(data[!is.na(data[, c]), c]) > 1) {#
			columnsWithData <- c(columnsWithData, c)#
		}#
	}#
	columnsWithData#
}#
#
compareElementsOfASample<-function(data, folder, description, columnsToCompare) {#
	print(paste("Comparing samples of", description))#
	columnsWithData<-filterColumnsWithData(data, columnsToCompare)#
	if(length(columnsWithData) > 0) {#
		uTestElementsOfASample(data, folder, description, columnsWithData)#
		boxPlot(data, folder, description, columnsWithData)	#
	}#
}#
#
compareAllElementsOfASample<-function(data, folder) {#
	print(paste("Processing", folder, "data"))#
	compareElementsOfASample(data, folder, "declarations by type",			i$localVariable:i$field)#
	compareElementsOfASample(data, folder, "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	compareElementsOfASample(data, folder, "parameters of methods",			i$privateMethodParameter:i$publicMethodParameter)#
	compareElementsOfASample(data, folder, "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	compareElementsOfASample(data, folder, "fields", 						i$privateField:i$publicField)#
	compareElementsOfASample(data, folder, "declarations by visibility", 	i$private:i$public)#
}#
#
analyzeSample<-function(data, description) {#
	plotDeclarationTypeHistogramOfData(data, description)#
	compareAllElementsOfASample(data, description)	#
}
boxPlot(data_all, "all", "all combinations", i$localVariable:i$public)#
boxPlot(matureData, "mature", "all combinations", i$localVariable:i$public)#
boxPlot(nonMatureData, "non-mature", "all combinations", i$localVariable:i$public)
boxPlot(data_all, "all", "all combinations", i$localVariable:i$public)
analyzeSample(data_all, "all")
analyzeSample(smallData, "size/small")#
analyzeSample(mediumData, "size/medium")#
analyzeSample(bigData, "size/big")#
analyzeSample(hugeData, "size/huge")#
#
analyzeSample(testData, "test/test")#
analyzeSample(mainData, "test/main")#
#
analyzeSample(scriptData, "script/script")#
analyzeSample(classData, "script/class")#
#
analyzeSample(staticBackgroundData, "background/static-only")#
analyzeSample(dynamicBackgroundData, "background/dynamic-only")#
analyzeSample(staticAndDynamicBackgroundData, "background/static-and-dynamic")#
#
analyzeSample(staticAndDynamicBackgroundData, "background/static-and-dynamic")
describe(data)
describe(data_all)
data$loc==0
data[data$loc==0, ]
data_all$loc==0
data_all[data_all$loc==0, ]
describe(data_all[data_all$loc==0, ])
data_all<-read.table("parsed/declaration_by_type.txt", header=T)#
data_all<-data_all[data_all$loc>0, ]#
describe(data_all)#
#
data_tests_all<-read.table("parsed/declaration_by_tests.txt", header=T)#
data_tests_all<-data_tests_all[data_tests_all$loc>0, ]#
describe(data_tests_all)#
#
data_scripts_all<-read.table("parsed/declaration_by_scripts.txt", header=T)#
data_scripts_all<-data_scripts_all[data_scripts_all$loc>0, ]#
describe(data_scripts_all)#
#
data_background_all<-read.table("parsed/declaration_by_background.txt", header=T)#
data_background_all<-data_background_all[data_background_all$loc>0, ]#
describe(data_background_all)#
#
testData=data_tests_all[data_tests_all$condition=="test", ]#
mainData=data_tests_all[data_tests_all$condition=="not-test", ]#
#
scriptData=data_scripts_all[data_scripts_all$condition=="script", ]#
classData=data_scripts_all[data_scripts_all$condition=="not-script", ]#
#
staticBackgroundData=data_background_all[data_background_all$condition=="static-only", ]#
dynamicBackgroundData=data_background_all[data_background_all$condition=="dynamic-only", ]#
staticAndDynamicBackgroundData=data_background_all[data_background_all$condition=="static-and-dynamic", ]#
#
data_size=data_all#
data_size$condition=NA#
data_size[data_size$loc<=200, ]$condition="1-small"#
data_size[data_size$loc>200 & data_size$loc<=2000, ]$condition="2-medium"#
data_size[data_size$loc>2000 & data_size$loc<=20000, ]$condition="3-big"#
data_size[data_size$loc>20000, ]$condition="4-huge"#
#
smallData=data_size[data_size$condition=="1-small", ]#
mediumData=data_size[data_size$condition=="2-medium", ]#
bigData=data_size[data_size$condition=="3-big", ]#
hugeData=data_size[data_size$condition=="4-huge", ]
describe(data)
describe(data_all)
analyzeSample<-function(data, description) {#
	write(describe(data), paste("result/", description, "/descriptive_statistics.txt",  sep=""))#
	plotDeclarationTypeHistogramOfData(data, description)#
	compareAllElementsOfASample(data, description)	#
}
analyzeSample(data_all, "all")
class(describe(data_all))
str(data_all)
str(describe(data_all))
write.matrix(describe(data_all), file=paste("result/all/descriptive_statistics.txt",  sep=""))
write.matrix(do.call("rbind", describe(data_all)), file=paste("result/all/descriptive_statistics.txt",  sep=""))
write.matrix(describe(data_all), file=paste("result/all/descriptive_statistics.txt",  sep=""))
write.matrix(round(describe(data_all), 2), file=paste("result/all/descriptive_statistics.txt",  sep=""))
write.matrix(describe(data_all), file=paste("result/all/descriptive_statistics.txt",  sep=""))
str(describe(data_all))
library(psych)#
library(sm)#
library(ggplot2)#
library(MASS)#
#
setwd("~/workspace_gg/groovonomics/aosd_2014/analysis")#
#
data_all<-read.table("parsed/declaration_by_type.txt", header=T)#
data_all<-data_all[data_all$loc>0, ]#
describe(data_all)#
#
data_tests_all<-read.table("parsed/declaration_by_tests.txt", header=T)#
data_tests_all<-data_tests_all[data_tests_all$loc>0, ]#
describe(data_tests_all)#
#
data_scripts_all<-read.table("parsed/declaration_by_scripts.txt", header=T)#
data_scripts_all<-data_scripts_all[data_scripts_all$loc>0, ]#
describe(data_scripts_all)#
#
data_background_all<-read.table("parsed/declaration_by_background.txt", header=T)#
data_background_all<-data_background_all[data_background_all$loc>0, ]#
describe(data_background_all)#
#
testData=data_tests_all[data_tests_all$condition=="test", ]#
mainData=data_tests_all[data_tests_all$condition=="not-test", ]#
#
scriptData=data_scripts_all[data_scripts_all$condition=="script", ]#
classData=data_scripts_all[data_scripts_all$condition=="not-script", ]#
#
staticBackgroundData=data_background_all[data_background_all$condition=="static-only", ]#
dynamicBackgroundData=data_background_all[data_background_all$condition=="dynamic-only", ]#
staticAndDynamicBackgroundData=data_background_all[data_background_all$condition=="static-and-dynamic", ]#
#
data_size=data_all#
data_size$condition=NA#
data_size[data_size$loc<=200, ]$condition="1-small"#
data_size[data_size$loc>200 & data_size$loc<=2000, ]$condition="2-medium"#
data_size[data_size$loc>2000 & data_size$loc<=20000, ]$condition="3-big"#
data_size[data_size$loc>20000, ]$condition="4-huge"#
#
smallData=data_size[data_size$condition=="1-small", ]#
mediumData=data_size[data_size$condition=="2-medium", ]#
bigData=data_size[data_size$condition=="3-big", ]#
hugeData=data_size[data_size$condition=="4-huge", ]#
#
i<-data.frame(	#
				projectId=1,#
				loc=2,#
				commits=3,#
				age=4,#
#
				all=5, #
#
				localVariable=6,#
				methodReturn=7,#
				methodParameter=8,#
				constructorParameter=9,#
				field=10,#
				privateMethodReturn=11,#
				protectedMethodReturn=12,#
				publicMethodReturn=13,#
				privateMethodParameter=14,#
				protectedMethodParameter=15,#
				publicMethodParameter=16,#
				privateConstructorParameter=17,#
				protectedConstructorParameter=18,#
				publicConstructorParameter=19,#
				privateField=20,#
				protectedField=21,#
				publicField=22,#
				private=23,#
				protected=24,#
				public=25#
			)#
label<-c(#
		"project id",#
		"LOC",#
		"number of commits",#
		"age",#
		"all types",#
#
		"local variables",#
		"returns of methods",#
		"parameters of methods",#
		"parameters of constructors",#
		"fields",#
#
		"returns of private methods",#
		"returns of protected methods",#
		"returns of public methods",#
#
		"parameters of private methods",#
		"parameters of protected methods",#
		"parameters of public methods",#
#
		"parameters of private constructors",#
		"parameters of protected constructors",#
		"parameters of public constructors",#
#
		"private fields",#
		"protected fields",#
		"public fields",#
#
		"private fields and methods",#
		"protected fields and methods",#
		"public fields and methods"#
)#
#
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Usage of types in declarations of",  declarationTypeStr, "per project")) + #
 		xlim(0,1.1)#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$public )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
# Uses Mann Whitney tests to compare if two samples are equal#
uTestElementsOfASample<-function(data, folder, description, columns) {#
	result = data.frame(sample1=character(0), sample2=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	row = 1#
	for(i in columns) { #
		for(j in columns) { #
			if(i < j) {#
				d_i=data[!is.na(data[,i]),i]#
				d_j=data[!is.na(data[,i]),j]#
				test<-wilcox.test(d_i, d_j, conf.int=T)#
				print(test)#
				p=round(test$p.value, 3)#
				conf.int.min=round(test$conf.int[1], 3)#
				conf.int.max=round(test$conf.int[2], 3)#
				result <- rbind(result, data.frame(sample1=colnames(data)[i], sample2=colnames(data)[j], pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
				row=row+1#
			}#
		}#
	}#
	write.matrix(result ,file=paste("result/", folder, "/u-test/", gsub(" ", "_", description), ".txt", sep=""))#
}#
#
uTestSamples<-function(data1, data2, data1Description, data2Description, folder, columns) {#
	print(paste("Comparing", data1Description, "and", data2Description))#
	result = data.frame(element=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	for(c in columns) { #
		element=colnames(data1)[c]#
		print(element)#
		d_1=data1[!is.na(data1[,c]),c]#
		d_2=data2[!is.na(data2[,c]),c]#
		if(length(d_1) > 1 && length(d_2) > 1) {#
			test<-wilcox.test(d_1, d_2, conf.int=T)#
			print(test)#
			p=round(test$p.value, 3)#
			conf.int.min=round(test$conf.int[1], 3)#
			conf.int.max=round(test$conf.int[2], 3)#
			result <- rbind(result, data.frame(element=element, pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
		}#
	}#
	write.matrix(result ,file=paste("result/", folder, "/comparison/u-test/", data1Description, "_", data2Description, ".txt", sep=""))#
}#
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="")#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=7, height=length(columns))#
}#
#
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot() + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom")#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=7, height=max(3.0, 1.5*length(columns)))#
}#
#
compareAllSamples<-function() {#
	# Tests classes X Main classes#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "all declarations",			i$all)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "fields", 						i$privateField:i$publicField)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by visibility",	i$private:i$public)#
	uTestSamples(testData, mainData, "test", "main", "test", i$all:i$public)#
	# Scripts X Classes#
	comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "all declarations",		i$all)#
	comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "declarations by type",	i$localVariable:i$methodParameter)#
	uTestSamples(scriptData, classData, "script", "class", "script", c(i$all, i$localVariable:i$methodParameter))#
	# Programmers background#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "all declarations",			i$all)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by visibility",	i$private:i$public)#
	uTestSamples(staticBackgroundData, dynamicBackgroundData,			"static", "dynamic",			"background", i$all:i$public)#
	uTestSamples(staticBackgroundData, staticAndDynamicBackgroundData,	"static", "static-and-dynamic",	"background", i$all:i$public)#
	uTestSamples(dynamicBackgroundData, staticAndDynamicBackgroundData,	"dynamic", "static-and-dynamic","background", i$all:i$public)#
	# Size#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "all declarations",			i$all)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "declarations by visibility",	i$private:i$public)#
#
	uTestSamples(smallData, mediumData, "1-small", "2-medium", "size", i$all:i$public)#
	uTestSamples(smallData, bigData,	"1-small", "3-big", "size", i$all:i$public)#
	uTestSamples(smallData, hugeData,	"1-small", "4-huge", "size", i$all:i$public)#
	uTestSamples(mediumData, bigData,	"2-medium", "3-big", "size", i$all:i$public)#
	uTestSamples(mediumData, hugeData,	"2-medium", "4-huge", "size", i$all:i$public)#
	uTestSamples(bigData, hugeData,		"3-big", "4-huge", "size", i$all:i$public)#
#
}#
#
filterColumnsWithData<-function(data, columns) {#
	columnsWithData=numeric()#
	for(c in columns) {#
		if(length(data[!is.na(data[, c]), c]) > 1) {#
			columnsWithData <- c(columnsWithData, c)#
		}#
	}#
	columnsWithData#
}#
#
compareElementsOfASample<-function(data, folder, description, columnsToCompare) {#
	print(paste("Comparing samples of", description))#
	columnsWithData<-filterColumnsWithData(data, columnsToCompare)#
	if(length(columnsWithData) > 0) {#
		uTestElementsOfASample(data, folder, description, columnsWithData)#
		boxPlot(data, folder, description, columnsWithData)	#
	}#
}#
#
compareAllElementsOfASample<-function(data, folder) {#
	print(paste("Processing", folder, "data"))#
	compareElementsOfASample(data, folder, "declarations by type",			i$localVariable:i$field)#
	compareElementsOfASample(data, folder, "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	compareElementsOfASample(data, folder, "parameters of methods",			i$privateMethodParameter:i$publicMethodParameter)#
	compareElementsOfASample(data, folder, "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	compareElementsOfASample(data, folder, "fields", 						i$privateField:i$publicField)#
	compareElementsOfASample(data, folder, "declarations by visibility", 	i$private:i$public)#
}#
#
analyzeSample<-function(data, description) {#
	plotDeclarationTypeHistogramOfData(data, description)#
	compareAllElementsOfASample(data, description)	#
}#
#
boxPlot(data_all, "all", "all combinations", i$localVariable:i$public)#
#
analyzeSample(data_all, "all")
analyzeSample<-function(data, description) {#
	plotDeclarationTypeHistogramOfData(data, description)#
	# compareAllElementsOfASample(data, description)	#
}#
#
boxPlot(data_all, "all", "all combinations", i$localVariable:i$public)#
#
analyzeSample(data_all, "all")#
#
analyzeSample(smallData, "size/small")#
analyzeSample(mediumData, "size/medium")#
analyzeSample(bigData, "size/big")#
analyzeSample(hugeData, "size/huge")#
#
analyzeSample(testData, "test/test")#
analyzeSample(mainData, "test/main")#
#
analyzeSample(scriptData, "script/script")#
analyzeSample(classData, "script/class")#
#
analyzeSample(staticBackgroundData, "background/static-only")#
analyzeSample(dynamicBackgroundData, "background/dynamic-only")#
analyzeSample(staticAndDynamicBackgroundData, "background/static-and-dynamic")#
#
analyzeSample(staticAndDynamicBackgroundData, "background/static-and-dynamic")
describe(data_all)
exp(mean(log(dara_all$all)))
exp(mean(log(data_all$all)))
exp(mean(log(data_all$all[!is.na(data_all$all)])))
exp(mean(log(data_all$all[!is.na(data_all$all), ])))
data_all$all[!is.na(data_all$all), ]
data_all$all[!is.na(data_all$all), ]
data_all$all
data_all[is.na(data_all$all), ]
length(data_all[is.na(data_all$all), ])
data_all<-read.table("parsed/declaration_by_type.txt", header=T)#
data_all<-data_all[data_all$loc>0 & !is.na(data_all$all), ]#
describe(data_all)
quantile(data_all$all, .25)
quantile(data_all$all, .5)
quantile(data_all$all, .75)
quantile(data_all$all, 1)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.1) +#
 		theme(plot.margin=0)#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}
plotDeclarationTypeHistogram(data_all$all, "all", 5)
analyzeSample(data_all, "all")
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.1) +#
 		theme(plot.margin=unit(0, "cm")#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.1) +#
 		theme(plot.margin=unit(0, "cm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}
analyzeSample(data_all, "all")
unit(0, "cm"")
"
unit(0, "cm")
library(grid)
unit(0, "cm")
analyzeSample(data_all, "all")
par(mar=c(0,0,0,0))
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.1)#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}
analyzeSample(data_all, "all")
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.1) +#
 		theme(plot.margin=unit(0.01, "cm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}
analyzeSample(data_all, "all")
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.1)#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.1) +#
 		theme(plot.margin=plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
analyzeSample(data_all, "all")
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.1) +#
 		theme(plot.margin=plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$all )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
analyzeSample(data_all, "all")
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.0) +#
 		theme(plot.margin=plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$all )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
analyzeSample(data_all, "all")
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.2) +#
 		theme(plot.margin=plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$all )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
analyzeSample(data_all, "all")
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,2.0) +#
 		theme(plot.margin=plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$all )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
analyzeSample(data_all, "all")
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,0.5) +#
 		theme(plot.margin=plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,0.5) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$all )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.5) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$all )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.0) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$all )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
plotDeclarationTypeHistogram(data_all, "all", 5
)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.2) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=3, width=7)#
}#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$all )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$all )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}#
plotDeclarationTypeHistogramOfData<-function(data, folder){#
	for(it in filterColumnsWithData(data, i$all:i$public )) {#
		print(it)#
		plotDeclarationTypeHistogram(data, folder, it )		#
	}#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05, position_dodge=0.75) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	# Unify the intervals of [0.95,1.0[ and [1.0,1.05[ since this last one only contains values == 1.0#
 	values[values==1.0] = 0.99#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05, position_dodge=0.75) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	# Unify the intervals of [0.95,1.0[ and [1.0,1.05[ since this last one only contains values == 1.0#
 	replace(values, values==1.0, 0.99)#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05, position_dodge=0.75) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	# Unify the intervals of [0.95,1.0[ and [1.0,1.05[ since this last one only contains values == 1.0#
 	replace(values, values==1.0, 0.0)#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05, position_dodge=0.75) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
x=c(2,2,2)
replace(x, x==2, 3)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	# Unify the intervals of [0.95,1.0[ and [1.0,1.05[ since this last one only contains values == 1.0#
 	values<-replace(values, values==1.0, 0.0)#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05, position_dodge=0.75) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	# Unify the intervals of [0.95,1.0[ and [1.0,1.05[ since this last one only contains values == 1.0#
 	print(values)#
 	print(class(values))#
 	values<-replace(values, values==1.0, 0.0)#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05, position_dodge=0.75) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	# Unify the intervals of [0.95,1.0[ and [1.0,1.05[ since this last one only contains values == 1.0#
 	print(values)#
 	print(class(values))#
 	values<-replace(values, values==1.0, 0.0)#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05, position_dodge=0.75) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}#
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	# Unify the intervals of [0.95,1.0[ and [1.0,1.05[ since this last one only contains values == 1.0#
 	print(values)#
 	print(class(values))#
 	values<-replace(values, values==1.0, 0.0)#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	# Unify the intervals of [0.95,1.0[ and [1.0,1.05[ since this last one only contains values == 1.0.#
 	# This is used on these histograms only#
 	values<-replace(values, values==1.0, 0.99)#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.05) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}
plotDeclarationTypeHistogram(data_all, "all", 5)
plotDeclarationTypeHistogram<-function(data, folder, index){#
	declarationTypeStr<-label[index]#
 	values<-data[!is.na(data[,index]),]#
 	colname<-colnames(data)[index]#
 	# Unify the intervals of [0.95,1.0[ and [1.0,1.05[ since this last one only contains values == 1.0.#
 	# This is used on these histograms only#
 	values<-replace(values, values==1.0, 0.99)#
 	plot<-ggplot(values, aes_string(x=colname)) + #
 		geom_histogram(binwidth=0.05) + #
 		ylab("Number of projects") + #
 		xlab(paste("Relative use of types in declarations")) + #
 		xlim(0,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/histograms/", sep=""), filename=paste(index, "_", gsub(" ", "_", declarationTypeStr), ".png", sep=""), plot, height=2.5, width=5)#
}
plotDeclarationTypeHistogram(data_all, "all", 5)
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.x=element_blank())#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=7, height=length(columns))#
}
analyzeSample<-function(data, description) {#
	# plotDeclarationTypeHistogramOfData(data, description)#
	compareAllElementsOfASample(data, description)	#
}#
#
boxPlot(data_all, "all", "all combinations", i$localVariable:i$public)
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.x=element_blank())#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=7, height=length(columns))#
}#
#
analyzeSample<-function(data, description) {#
	# plotDeclarationTypeHistogramOfData(data, description)#
	compareAllElementsOfASample(data, description)	#
}#
#
boxPlot(data_all, "all", "all combinations", i$localVariable:i$public)#
#
analyzeSample(data_all, "all")
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.y=element_blank())#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=7, height=length(columns))#
}#
#
analyzeSample<-function(data, description) {#
	# plotDeclarationTypeHistogramOfData(data, description)#
	compareAllElementsOfASample(data, description)	#
}#
#
boxPlot(data_all, "all", "all combinations", i$localVariable:i$public)
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=7, height=length(columns))#
}#
#
analyzeSample<-function(data, description) {#
	# plotDeclarationTypeHistogramOfData(data, description)#
	compareAllElementsOfASample(data, description)	#
}#
#
boxPlot(data_all, "all", "all combinations", i$localVariable:i$public)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot() + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=7, height=max(3.0, 1.5*length(columns)))#
}
analyzeSample(data_all, "all")
analyzeSample(smallData, "size/small")#
analyzeSample(mediumData, "size/medium")#
analyzeSample(bigData, "size/big")#
analyzeSample(hugeData, "size/huge")#
#
analyzeSample(testData, "test/test")#
analyzeSample(mainData, "test/main")#
#
analyzeSample(scriptData, "script/script")#
analyzeSample(classData, "script/class")#
#
analyzeSample(staticBackgroundData, "background/static-only")#
analyzeSample(dynamicBackgroundData, "background/dynamic-only")#
analyzeSample(staticAndDynamicBackgroundData, "background/static-and-dynamic")#
#
analyzeSample(staticAndDynamicBackgroundData, "background/static-and-dynamic")
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=6, height=length(columns)*0.8)#
}
boxPlot(data_all, "all", "all combinations", i$localVariable:i$public)
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=6, height=length(columns)*0.7)#
}
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot() + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=7, height=max(3.0, 1.5*0.8*length(columns)))#
}
analyzeSample(data_all, "all")
label<-c(#
		"project id",#
		"LOC",#
		"number of commits",#
		"age",#
		"all types",#
#
		"local\nvariables",#
		"returns of\nmethods",#
		"parameters of\nmethods",#
		"parameters of\nconstructors",#
		"fields",#
#
		"returns of private methods",#
		"returns of protected methods",#
		"returns of public methods",#
#
		"parameters of private methods",#
		"parameters of protected methods",#
		"parameters of public methods",#
#
		"parameters of private constructors",#
		"parameters of protected constructors",#
		"parameters of public constructors",#
#
		"private fields",#
		"protected fields",#
		"public fields",#
#
		"private fields and methods",#
		"protected fields and methods",#
		"public fields and methods"#
)
analyzeSample(data_all, "all")
compareElementsOfASample<-function(data, folder, description, columnsToCompare) {#
	print(paste("Comparing samples of", description))#
	columnsWithData<-filterColumnsWithData(data, columnsToCompare)#
	if(length(columnsWithData) > 0) {#
		# uTestElementsOfASample(data, folder, description, columnsWithData)#
		boxPlot(data, folder, description, columnsWithData)	#
	}#
}
analyzeSample<-function(data, description) {#
	# plotDeclarationTypeHistogramOfData(data, description)#
	compareAllElementsOfASample(data, description)	#
}
analyzeSample(data_all, "all")
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot() + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=6, height=max(3.0, 1.5*0.8*length(columns)))#
}
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=5, height=length(columns)*0.6)#
}
analyzeSample(data_all, "all")
label<-c(#
		"project id",#
		"LOC",#
		"number of commits",#
		"age",#
		"all types",#
#
		"local\nvariables",#
		"returns of\nmethods",#
		"parameters of\nmethods",#
		"parameters of\nconstructors",#
		"fields",#
#
		"returns of\nprivate methods",#
		"returns of\nprotected methods",#
		"returns of\npublic methods",#
#
		"parameters of\nprivate methods",#
		"parameters of\nprotected methods",#
		"parameters of\npublic methods",#
#
		"parameters of\nprivate constructors",#
		"parameters of\nprotected constructors",#
		"parameters of\npublic constructors",#
#
		"private fields",#
		"protected fields",#
		"public fields",#
#
		"private",#
		"protected",#
		"public"#
)
analyzeSample(data_all, "all")
sd(data_all$all)
getDescriptiveStatistics<-function(data, folder, description, columnsWithData){#
	result = data.frame(element=character(0), n=numeric(0), mean=numeric(0), sd=numeric(0), q1=numeric(0), q2=numeric(0), q3=numeric(0), q4=numeric(0))#
	for(c in columns) { #
		d=data[!is.na(data[c]), c]#
		element=colnames(data)[c]#
		n=length(d)#
		mean=mean(d)#
		sd=round(sd(d), 2)#
		q1=round(quantile(d, .25))#
		q2=round(quantile(d, .50))#
		q3=round(quantile(d, .75))#
		q4=round(quantile(d, 1.0))#
		result <- rbind(result, data.frame(element=element, n=n, mean=mean(d), sd=sd, q1=q1, q2=q2, q3=q3, q4=q4) )#
	}#
	write.matrix(result ,file=paste("result/", folder, "/descriptive/", gsub(" ", "_", description), ".txt", sep=""))#
}
getDescriptiveStatistics<-function(data, folder, description, columnsWithData){#
	result = data.frame(element=character(0), n=numeric(0), mean=numeric(0), sd=numeric(0), q1=numeric(0), q2=numeric(0), q3=numeric(0), q4=numeric(0))#
	for(c in columns) { #
		d=data[!is.na(data[c]), c]#
		element=colnames(data)[c]#
		n=length(d)#
		mean=mean(d)#
		sd=round(sd(d), 2)#
		q1=round(quantile(d, .25))#
		q2=round(quantile(d, .50))#
		q3=round(quantile(d, .75))#
		q4=round(quantile(d, 1.0))#
		result <- rbind(result, data.frame(element=element, n=n, mean=mean(d), sd=sd, q1=q1, q2=q2, q3=q3, q4=q4) )#
	}#
	write.matrix(result ,file=paste("result/", folder, "/descriptive/", gsub(" ", "_", description), ".txt", sep=""))#
}#
getDescriptiveStatistics(data_all, "all", "types", i$localVariable:i$field)
getDescriptiveStatistics<-function(data, folder, description, columns){#
	result = data.frame(element=character(0), n=numeric(0), mean=numeric(0), sd=numeric(0), q1=numeric(0), q2=numeric(0), q3=numeric(0), q4=numeric(0))#
	for(c in columns) { #
		d=data[!is.na(data[c]), c]#
		element=colnames(data)[c]#
		n=length(d)#
		mean=mean(d)#
		sd=round(sd(d), 2)#
		q1=round(quantile(d, .25))#
		q2=round(quantile(d, .50))#
		q3=round(quantile(d, .75))#
		q4=round(quantile(d, 1.0))#
		result <- rbind(result, data.frame(element=element, n=n, mean=mean(d), sd=sd, q1=q1, q2=q2, q3=q3, q4=q4) )#
	}#
	write.matrix(result ,file=paste("result/", folder, "/descriptive/", gsub(" ", "_", description), ".txt", sep=""))#
}#
getDescriptiveStatistics(data_all, "all", "types", i$localVariable:i$field)
getDescriptiveStatistics<-function(data, folder, description, columns){#
	result = data.frame(element=character(0), n=numeric(0), mean=numeric(0), sd=numeric(0), q1=numeric(0), q2=numeric(0), q3=numeric(0), q4=numeric(0))#
	for(c in columns) { #
		d=data[!is.na(data[c]), c]#
		element=colnames(data)[c]#
		n=length(d)#
		mean=mean(d)#
		sd=round(sd(d), 2)#
		q1=round(quantile(d, .25))#
		q2=round(quantile(d, .50))#
		q3=round(quantile(d, .75))#
		q4=round(quantile(d, 1.0))#
		result <- rbind(result, data.frame(element=element, n=n, mean=mean(d), sd=sd, q1=q1, q2=q2, q3=q3, q4=q4) )#
	}#
	write.matrix(result ,file=paste("result/", folder, "/descriptive/", gsub(" ", "_", description), ".txt", sep=""))#
}#
getDescriptiveStatistics(data_all, "all", "types", i$localVariable:i$field)
getDescriptiveStatistics<-function(data, folder, description, columns){#
	result = data.frame(element=character(0), n=numeric(0), mean=numeric(0), sd=numeric(0), q1=numeric(0), q2=numeric(0), q3=numeric(0), q4=numeric(0))#
	for(c in columns) { #
		d=data[!is.na(data[c]), c]#
		element=colnames(data)[c]#
		n=length(d)#
		mean=mean(d)#
		sd=round(sd(d), 2)#
		q1=round(quantile(d, .25), 2)#
		q2=round(quantile(d, .50), 2)#
		q3=round(quantile(d, .75), 2)#
		q4=round(quantile(d, 1.0), 2)#
		result <- rbind(result, data.frame(element=element, n=n, mean=mean(d), sd=sd, q1=q1, q2=q2, q3=q3, q4=q4) )#
	}#
	write.matrix(result ,file=paste("result/", folder, "/descriptive/", gsub(" ", "_", description), ".txt", sep=""))#
}#
getDescriptiveStatistics(data_all, "all", "types", i$localVariable:i$field)
compareElementsOfASample<-function(data, folder, description, columnsToCompare) {#
	print(paste("Comparing samples of", description))#
	columnsWithData<-filterColumnsWithData(data, columnsToCompare)#
	if(length(columnsWithData) > 0) {#
		# uTestElementsOfASample(data, folder, description, columnsWithData)#
		boxPlot(data, folder, description, columnsWithData)	#
		getDescriptiveStatistics(data, folder, description, columnsWithData)	#
	}#
}
analyzeSample(data_all, "all")
getDescriptiveStatistics<-function(data, folder, description, columns){#
	result = data.frame(element=character(0), n=numeric(0), mean=numeric(0), sd=numeric(0), q1=numeric(0), q2=numeric(0), q3=numeric(0), q4=numeric(0))#
	for(c in columns) { #
		d=data[!is.na(data[c]), c]#
		element=colnames(data)[c]#
		n=length(d)#
		mean=round(mean(d), 2)#
		sd=round(sd(d), 2)#
		q1=round(quantile(d, .25), 2)#
		q2=round(quantile(d, .50), 2)#
		q3=round(quantile(d, .75), 2)#
		q4=round(quantile(d, 1.0), 2)#
		result <- rbind(result, data.frame(element=element, n=n, mean=mean(d), sd=sd, q1=q1, q2=q2, q3=q3, q4=q4) )#
	}#
	write.matrix(result ,file=paste("result/", folder, "/descriptive/", gsub(" ", "_", description), ".txt", sep=""))#
}
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm")) +#
			scale_x_reverse()#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=5, height=length(columns)*0.6)#
}
boxPlot(data_all, "all", "all combinations", i$localVariable:i$public)
label<-c(#
		"project id",#
		"LOC",#
		"number of commits",#
		"age",#
		"all types",#
#
		"Local\nVariable",#
		"Method\nReturn",#
		"Method\nParameter",#
		"Constructor\nParameter",#
		"Field",#
#
		"Private",#
		"Protected",#
		"Public",#
#
		"Private",#
		"Protected",#
		"Public",#
#
		"Private",#
		"Protected",#
		"Public",#
#
		"Private",#
		"Protected",#
		"Public",#
#
		"Private",#
		"Protected",#
		"Public"#
)
analyzeSample(data_all, "all")
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(notch=T) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=5, height=length(columns)*0.6)#
}
analyzeSample(data_all, "all")
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot() + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=5, height=length(columns)*0.6)#
}#
analyzeSample<-function(data, description) {#
	# plotDeclarationTypeHistogramOfData(data, description)#
	compareAllElementsOfASample(data, description)	#
}#
#
analyzeSample(data_all, "all")
describe(data_all)
describe(data_all)
uTestElementsOfASample<-function(data, folder, description, columns) {#
	result = data.frame(sample1=character(0), sample2=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	row = 1#
	for(i in columns) { #
		for(j in columns) { #
				d_i=data[!is.na(data[,i]),i]#
				d_j=data[!is.na(data[,i]),j]#
				test<-wilcox.test(d_i, d_j, conf.int=T)#
				print(test)#
				p=round(test$p.value, 3)#
				conf.int.min=round(test$conf.int[1], 3)#
				conf.int.max=round(test$conf.int[2], 3)#
				result <- rbind(result, data.frame(sample1=colnames(data)[i], sample2=colnames(data)[j], pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
				row=row+1#
		}#
	}#
	write.matrix(result ,file=paste("result/", folder, "/u-test/", gsub(" ", "_", description), ".txt", sep=""))#
}
analyzeSample(data_all, "all")
compareElementsOfASample<-function(data, folder, description, columnsToCompare) {#
	print(paste("Comparing samples of", description))#
	columnsWithData<-filterColumnsWithData(data, columnsToCompare)#
	if(length(columnsWithData) > 0) {#
		uTestElementsOfASample(data, folder, description, columnsWithData)#
		boxPlot(data, folder, description, columnsWithData)	#
		getDescriptiveStatistics(data, folder, description, columnsWithData)	#
	}#
}
analyzeSample(data_all, "all")
Uses Mann Whitney tests to compare if two samples are equal#
uTestElementsOfASample<-function(data, folder, description, columns) {#
	result = data.frame(sample1=character(0), sample2=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	for(i in columns) { #
		for(j in columns) { #
				d_i=data[!is.na(data[,i]),i]#
				d_j=data[!is.na(data[,i]),j]#
				test<-wilcox.test(d_i, d_j, conf.int=T)#
				print(test)#
				p=round(test$p.value, 3)#
				conf.int.min=round(test$conf.int[1], 3)#
				conf.int.max=round(test$conf.int[2], 3)#
				result <- rbind(result, data.frame(sample1=colnames(data)[i], sample2=colnames(data)[j], pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
		}#
	}#
	write.matrix(result ,file=paste("result/", folder, "/u-test/", gsub(" ", "_", description), ".txt", sep=""))#
}
analyzeSample(data_all, "all")
Uses Mann Whitney tests to compare if two samples are equal#
uTestElementsOfASample<-function(data, folder, description, columns) {#
	result = data.frame(sample1=character(0), sample2=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	for(i in columns) { #
		for(j in columns) { #
			d_i=data[!is.na(data[,i]),i]#
			d_j=data[!is.na(data[,i]),j]#
			test<-wilcox.test(d_i, d_j, conf.int=T)#
			print(test)#
			p=round(test$p.value, 3)#
			conf.int.min=round(test$conf.int[1], 3)#
			conf.int.max=round(test$conf.int[2], 3)#
			result <- rbind(result, data.frame(sample1=colnames(data)[i], sample2=colnames(data)[j], pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
		}#
	}#
	write.matrix(result ,file=paste("result/", folder, "/u-test/", gsub(" ", "_", description), ".txt", sep=""))#
}
Uses Mann Whitney tests to compare if two samples are equal#
uTestElementsOfASample<-function(data, folder, description, columns) {#
	result = data.frame(sample1=character(0), sample2=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	for(i in columns) { #
		for(j in columns) { #
			d_i=data[!is.na(data[,i]),i]#
			d_j=data[!is.na(data[,i]),j]#
			test<-wilcox.test(d_i, d_j, conf.int=T)#
			print(test)#
			p=round(test$p.value, 3)#
			conf.int.min=round(test$conf.int[1], 3)#
			conf.int.max=round(test$conf.int[2], 3)#
			result <- rbind(result, data.frame(sample1=colnames(data)[i], sample2=colnames(data)[j], pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
		}#
	}#
	filename=paste("result/", folder, "/u-test/", gsub(" ", "_", description), ".txt", sep="")#
	write.matrix(result ,file=filename)#
}
uTestElementsOfASample(data_all, "all", "hello_world.txt", i$privateField:i$publicField)
uTestElementsOfASample<-function(data, folder, description, columns) {#
	result = data.frame(sample1=character(0), sample2=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	for(i in columns) { #
		for(j in columns) { #
			d_i=data[!is.na(data[,i]),i]#
			d_j=data[!is.na(data[,i]),j]#
			test<-wilcox.test(d_i, d_j, conf.int=T)#
			print(test)#
			p=round(test$p.value, 3)#
			conf.int.min=round(test$conf.int[1], 3)#
			conf.int.max=round(test$conf.int[2], 3)#
			result <- rbind(result, data.frame(sample1=colnames(data)[i], sample2=colnames(data)[j], pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
		}#
	}#
	filename=paste("result/", folder, "/u-test/", gsub(" ", "_", description), ".txt", sep="")#
	write.matrix(result ,file=filename)#
}
analyzeSample(data_all, "all")
Uses Mann Whitney tests to compare if two samples are equal#
uTestElementsOfASample<-function(data, folder, description, columns) {#
	filename=paste("result/", folder, "/u-test/", gsub(" ", "_", description), ".txt", sep="")#
	print(paste("Processing", filename))#
	result = data.frame(sample1=character(0), sample2=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	for(i in columns) { #
		for(j in columns) { #
			d_i=data[!is.na(data[,i]),i]#
			d_j=data[!is.na(data[,i]),j]#
			test<-wilcox.test(d_i, d_j, conf.int=T)#
			p=round(test$p.value, 3)#
			conf.int.min=round(test$conf.int[1], 3)#
			conf.int.max=round(test$conf.int[2], 3)#
			result <- rbind(result, data.frame(sample1=colnames(data)[i], sample2=colnames(data)[j], pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
		}#
	}#
	write.matrix(result ,file=filename)#
}
analyzeSample(data_all, "all")
Uses Mann Whitney tests to compare if two samples are equal#
uTestElementsOfASample<-function(data, folder, description, columns) {#
	filename=paste("result/", folder, "/u-test/", gsub(" ", "_", description), ".txt", sep="")#
	print(paste("Processing", filename))#
	result = data.frame(sample1=character(0), sample2=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	for(i in columns) { #
		for(j in columns) { #
			d_i=data[!is.na(data[,i]),i]#
			d_j=data[!is.na(data[,i]),j]#
			test<-wilcox.test(d_i, d_j, conf.int=T)#
			p=round(test$p.value, 3)#
			conf.int.min=round(test$conf.int[1], 2)#
			conf.int.max=round(test$conf.int[2], 2)#
			result <- rbind(result, data.frame(sample1=colnames(data)[i], sample2=colnames(data)[j], pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
		}#
	}#
	write.matrix(result ,file=filename)#
}
analyzeSample(data_all, "all")
boxPlot<-function(data, folder, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0))#
	for(c in columns) {#
		d <- rbind( d, data.frame(label=label[c], value=data[!is.na(data[c]), c]) )#
	}#
	plot<-ggplot(d, aes(label, value)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description)) +#
			theme(axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/boxplots/",  sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=5, height=length(columns)*0.6)#
}
analyzeSample(data_all, "all")
norm(1:1000)
describe(rnorm(n=500, m=1, sd=1) )
a=rnorm(n=500, m=1, sd=1)
b=rnorm(n=412, m=2, sd=1.3)
wilcox.test(a, b, conf.int=T)
wilcox.test(b, a, conf.int=T)
Uses Mann Whitney tests to compare if two samples are equal#
uTestElementsOfASample<-function(data, folder, description, columns) {#
	filename=paste("result/", folder, "/u-test/", gsub(" ", "_", description), ".txt", sep="")#
	print(paste("Processing", filename))#
	result = data.frame(sample1=character(0), sample2=character(0), pvalue=numeric(0), conf.int.min=numeric(0), conf.int.max=numeric(0))#
	for(i in columns) { #
		for(j in columns) { #
			d_i=data[!is.na(data[,i]),i]#
			d_j=data[!is.na(data[,j]),j]#
			test<-wilcox.test(d_i, d_j, conf.int=T)#
			p=round(test$p.value, 3)#
			conf.int.min=round(test$conf.int[1], 2)#
			conf.int.max=round(test$conf.int[2], 2)#
			result <- rbind(result, data.frame(sample1=colnames(data)[i], sample2=colnames(data)[j], pvalue=p, conf.int.min=conf.int.min, conf.int.max=conf.int.max))#
		}#
	}#
	write.matrix(result ,file=filename)#
}
analyzeSample(data_all, "all")
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot() + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=6, height=max(3.0, 1.5*0.8*length(columns)))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "all declarations",			i$all)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "fields", 						i$privateField:i$publicField)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by visibility",	i$private:i$public)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot() + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=5, height=max(3.0, 1.5*0.8*length(columns)))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=5, height=max(3.0, 1.5*0.8*length(columns)))#
}
Tests classes X Main classes#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "all declarations",			i$all)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "fields", 						i$privateField:i$publicField)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by visibility",	i$private:i$public)#
	uTestSamples(testData, mainData, "test", "main", "test", i$all:i$public)#
	# Scripts X Classes#
	comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "all declarations",		i$all)#
	comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "declarations by type",	i$localVariable:i$methodParameter)#
	uTestSamples(scriptData, classData, "script", "class", "script", c(i$all, i$localVariable:i$methodParameter))
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 1.5*0.8*length(columns)))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "all declarations",			i$all)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "fields", 						i$privateField:i$publicField)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by visibility",	i$private:i$public)
comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "all declarations",		i$all)#
	comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "declarations by type",	i$localVariable:i$methodParameter)
analyzeSample(data_all, "all")
compareElementsOfASample<-function(data, folder, description, columnsToCompare) {#
	print(paste("Comparing samples of", description))#
	columnsWithData<-filterColumnsWithData(data, columnsToCompare)#
	if(length(columnsWithData) > 0) {#
		# uTestElementsOfASample(data, folder, description, columnsWithData)#
		# boxPlot(data, folder, description, columnsWithData)	#
		getDescriptiveStatistics(data, folder, description, columnsWithData)	#
	}#
}
analyzeSample(data_all, "all")
getDescriptiveStatistics<-function(data, folder, description, columns){#
	result = data.frame(element=character(0), n=numeric(0), mean=numeric(0), sd=numeric(0), median=numeric(0))#
	for(c in columns) { #
		d=data[!is.na(data[c]), c]#
		element=colnames(data)[c]#
		n=length(d)#
		mean=round(mean(d), 2)#
		sd=round(sd(d), 2)#
		median=round(median(d), 2)#
		result <- rbind(result, data.frame(element=element, n=n, mean=mean(d), sd=sd, median=median) )#
	}#
	write.matrix(result ,file=paste("result/", folder, "/descriptive/", gsub(" ", "_", description), ".txt", sep=""))#
}
analyzeSample(data_all, "all")
analyzeSample(testData, "test/test")#
analyzeSample(mainData, "test/main")
analyzeSample(scriptData, "script/script")#
analyzeSample(classData, "script/class")
data_size$condition
length(data_size$condition)
length(unique(data_size$condition))
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 1.5*0.8* length(unique(d$condition)/2)))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i
comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "all declarations",			i$all)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by visibility",	i$private:i$public)
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 1.5*0.8* length(unique(d$condition))/2))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 1.5*0.8* length(unique(d$condition))))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
			print(length(unique(d$condition)))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 1.5*0.8* length(unique(d$condition))))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
			print(length(unique(d$condition)))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 1.5*0.8* 2*length(unique(d$condition))))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
			print(length(unique(d$condition)))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 1.5*0.8* 4*length(unique(d$condition))/2))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "all declarations",			i$all)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)
comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "all declarations",			i$all)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by visibility",	i$private:i$public)
comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "all declarations",			i$all)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "declarations by visibility",	i$private:i$public)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 0.2*length(columns)*length(unique(d$condition))/2))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "all declarations",			i$all)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "fields", 						i$privateField:i$publicField)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by visibility",	i$private:i$public)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 0.4*length(columns)*length(unique(d$condition))/2))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, length(columns)*length(unique(d$condition))/2))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)
comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "declarations by type",	i$localVariable:i$methodParameter)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.25, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 1.2*length(columns)*length(unique(d$condition))/2))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)
comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "declarations by type",	i$localVariable:i$methodParameter)
comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "all declarations",			i$all)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "declarations by visibility",	i$private:i$public)
comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "all declarations",			i$all)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by visibility",	i$private:i$public)
comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "all declarations",		i$all)#
	comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "declarations by type",	i$localVariable:i$methodParameter)
testData
data_tests_all<-read.table("parsed/declaration_by_tests.txt", header=T)#
data_tests_all<-data_tests_all[data_tests_all$loc>0, ]#
describe(data_tests_all)
testData
describe(testData)
comparisonBoxPlot<-function(data, folder, labels, description, columns) {#
	d <- data.frame(label=character(0), value=numeric(0), condition=character(0))#
	for(c in columns) {#
		filteredData <- data[!is.na(data[c]), ]#
		d <- rbind( d, data.frame( label=label[c], value=filteredData[,c], condition=filteredData$condition ) )#
	}#
	plot<-ggplot(d, aes(label, value, fill=condition)) + #
			geom_boxplot(outlier.size=0) + #
			coord_flip() + #
			labs(y=paste("Use of types in", description), x="") + #
			scale_fill_grey(start=0.4, end=1, name="", labels=labels) +#
			theme(legend.position="bottom", axis.title.y=element_blank(), plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", folder, "/comparison/boxplots", sep=""), filename=paste(columns, "_", gsub(" ", "_", description), ".png", sep=""), plot, width=4.5, height=max(3.0, 1.2*length(columns)*length(unique(d$condition))/2))#
}
comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "all declarations",			i$all)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "fields", 						i$privateField:i$publicField)#
	comparisonBoxPlot(data_tests_all, "test", c("Main classes", "Test classes"), "declarations by visibility",	i$private:i$public)
comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "all declarations",			i$all)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_background_all, "background", c("Dynamically\nTyped Only", "Statically and\nDynamically Typed", "Statically\nTyped Only"), "declarations by visibility",	i$private:i$public)
comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "all declarations",			i$all)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "declarations by type",		i$localVariable:i$field)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "returns of methods",			i$privateMethodReturn:i$publicMethodReturn)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "parameters of methods",		i$privateMethodParameter:i$publicMethodParameter)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "parameters of constructors",	i$privateConstructorParameter:i$publicConstructorParameter)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "fields", 					i$privateField:i$publicField)#
	comparisonBoxPlot(data_size, "size", c("Small\nProjects", "Medium\nProjects", "Big\nProjects", "Very Big\nProjects"), "declarations by visibility",	i$private:i$public)
Scripts X Classes#
	comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "all declarations",		i$all)#
	comparisonBoxPlot(data_scripts_all, "script", c("Class files", "Script files"), "declarations by type",	i$localVariable:i$methodParameter)
analyzeSample(staticBackgroundData, "background/static-only")#
analyzeSample(dynamicBackgroundData, "background/dynamic-only")#
analyzeSample(staticAndDynamicBackgroundData, "background/static-and-dynamic")
analyzeSample(smallData, "size/small")#
analyzeSample(mediumData, "size/medium")#
analyzeSample(bigData, "size/big")#
analyzeSample(hugeData, "size/huge")
getDescriptiveStatistics<-function(data, folder, description, columns){#
	result = data.frame(element=character(0), n=numeric(0), mean=numeric(0), median=numeric(0), sd=numeric(0))#
	for(c in columns) { #
		d=data[!is.na(data[c]), c]#
		element=colnames(data)[c]#
		n=length(d)#
		mean=round(mean(d), 2)#
		sd=round(sd(d), 2)#
		median=round(median(d), 2)#
		result <- rbind(result, data.frame(element=element, n=n, mean=mean, median=median, sd=sd) )#
	}#
	write.matrix(result ,file=paste("result/", folder, "/descriptive/", gsub(" ", "_", description), ".txt", sep=""))#
}
analyzeSample(staticBackgroundData, "background/static-only")#
analyzeSample(dynamicBackgroundData, "background/dynamic-only")#
analyzeSample(staticAndDynamicBackgroundData, "background/static-and-dynamic")
change_commit_spearman = read.table("parsed/change_commit_spearman.txt")
qplot(change_commit_spearman)
describe(change_commit_spearman)
qplot(V1, data=change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	data = replace(data, data==1.0, 0.99)#
	plot<-ggplot(data, aes_string(x=V1)) + #
 		geom_histogram(binwidth=0.10) + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation between Frequency of changes and usage of types in a file")) + #
 		xlim(0,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	print(plot)#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2.5, width=5)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	values=data[,1]#
	values = replace(values, data==1.0, 0.99)#
	plot<-ggplot(data, aes_string(x=V1)) + #
 		geom_histogram(binwidth=0.10) + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation between Frequency of changes and usage of types in a file")) + #
 		xlim(0,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	print(plot)#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2.5, width=5)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	values=data[,1]#
	values = replace(values, data==1.0, 0.99)#
	plot<-ggplot(data) + #
 		geom_histogram(binwidth=0.10) + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation between Frequency of changes and usage of types in a file")) + #
 		xlim(0,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	print(plot)#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2.5, width=5)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		geom_histogram(binwidth=0.10) + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation between Frequency of changes and usage of types in a file")) + #
 		xlim(0,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	print(plot)#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2.5, width=5)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		geom_histogram(binwidth=0.10) + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(0,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2.5, width=5)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		geom_histogram(binwidth=0.10) + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2.5, width=5)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		stat_ecdf() + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	# ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2.5, width=5)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		stat_ecdf() + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	print(plot)#
	# ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2.5, width=5)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		stat_ecdf() + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	print(plot)#
	# ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2.5, width=5)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		stat_ecdf() + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2.5, width=5)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		stat_ecdf() + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2, width=3)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		stat_ecdf() + #
 		ylab("Number of projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2, width=4)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		geom_step() + #
 		ylab("Projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	print(plot)#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2, width=4)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		geom_step(data) + #
 		ylab("Projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	print(plot)#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2, width=4)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		geom_step(data, aes(x=V1)) + #
 		ylab("Projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	print(plot)#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2, width=4)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-qplot(count(data), data, geom="step") + #
 		ylab("Projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	print(plot)#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2, width=4)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
plotSpearmanDistributionHistogram<-function(data){#
	print(describe(data))#
	data = replace(data, data==1.0, 0.99)#
	data = replace(data, data==-1.0, -0.99)#
	plot<-ggplot(data, aes(x=V1)) + #
 		stat_ecdf() + #
 		ylab("Projects") + #
 		xlab(paste("Spearman Correlation")) + #
 		xlim(-1.00,1.00) +#
 		theme(plot.margin=unit(c(0,0,0,0),"mm"))#
	ggsave(path=paste("result/", sep=""), filename="change_commits_distribution.png", height=2, width=4)#
}#
plotSpearmanDistributionHistogram(change_commit_spearman)
